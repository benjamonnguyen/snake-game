(()=>{"use strict";const t={ArrowUp:"up",ArrowDown:"down",ArrowLeft:"left",ArrowRight:"right",KeyW:"w",KeyS:"s",KeyA:"a",KeyD:"d"};class e{constructor(t,e){this.coord=t,this.next=e}}const i=20,s=75,o=20,n=1e3,h=5;class a{constructor(t,e){this.x=t,this.y=e}drawRect(t,e,s){s.fillStyle=t,s.roundRect(i*this.x,i*this.y,i,i,e).fill()}clearRect(t){t.clearRect(i*this.x,i*this.y,i,i)}toString(){return this.x+","+this.y}}class r{constructor(t,e){this.body=new Set,this.score=0,this.color=t,this.direction=e,this.nextDirection=this.direction}initialize(t){let i=2,s=new e(new a(i,5),null);for(this.segmentCount=1,this.tail=s;this.segmentCount<5;)s.next=new e(new a(++i,5),null),s=s.next,this.segmentCount++;this.head=s,this.render(t)}render(t){let e=this.tail;for(;null!=e;)e.coord.drawRect(this.color,h,t),null!=e.next&&this.body.add(e.coord.toString()),e=e.next}move(i,s){let o;switch(i){case t.ArrowDown:case t.KeyS:o=new a(this.head.coord.x,this.head.coord.y+1);break;case t.ArrowUp:case t.KeyW:o=new a(this.head.coord.x,this.head.coord.y-1);break;case t.ArrowRight:case t.KeyD:o=new a(this.head.coord.x+1,this.head.coord.y);break;case t.ArrowLeft:case t.KeyA:o=new a(this.head.coord.x-1,this.head.coord.y)}this.tail.coord.clearRect(s),this.body.delete(this.tail.coord.toString()),this.head.next=new e(o,null),this.body.add(this.head.coord.toString()),this.head=this.head.next,this.tail=this.tail.next,this.head.coord.drawRect(this.color,h,s)}grow(){this.tail=new e(this.tail.coord,this.tail),this.body.add(this.tail.coord.toString())}}class d{constructor(t,e,i,s,o,n){this.ctx=t,this.infoDisplay=e,this.singleBtn=i,this.localBtn=s,this.width=o,this.height=n}async start(){this.ctx.clearRect(0,0,this.width,this.height),this.tickRate=s*n,this.snake=new r("#101f15",t.ArrowRight),this.snake.initialize(this.ctx),this.foodCoord=this.#t(),this.infoDisplay.innerText="SCORE: 0",this.#e()}#e(){this.snake.move(this.snake.nextDirection,this.ctx),this.snake.direction=this.snake.nextDirection,this.#i()?this.#s():(this.#o(),setTimeout((()=>this.#e()),Math.max(this.tickRate--/n,o)))}#i(){return!(!this.checkForBoundaryCollision(this.snake.head.coord)&&!this.snake.body.has(this.snake.head.coord.toString()))}#o(){this.snake.head.coord.x===this.foodCoord.x&&this.snake.head.coord.y===this.foodCoord.y&&(this.snake.grow(),this.foodCoord=this.#t(),this.infoDisplay.innerText="SCORE: "+ ++this.snake.score)}checkForBoundaryCollision(t){return t.x<0||t.x>this.width/i-1||t.y<0||t.y>this.height/i-1}#s(){this.singleBtn.style.display="inline",this.localBtn.style.display="inline"}#t(){let t;for(;!t||this.snake.body.has(t.toString());)t=new a(this.getRandomInt(this.width/i),this.getRandomInt(this.height/i));return t.drawRect("#d83a20",20,this.ctx),t}getRandomInt(t){return Math.floor(Math.random()*t)}}class c extends r{constructor(t,e){super(t,e)}initialize(t){let i=26,s=new e(new a(i,14),null),o=1;for(this.tail=s;o<5;)s.next=new e(new a(--i,14),null),s=s.next,o++;this.head=s,this.segmentCount=o,this.render(t)}}class l extends d{constructor(t,e,i,s,o,n){super(t,e,i,s,o,n)}async start(){this.ctx.clearRect(0,0,this.width,this.height),this.tickRate=s*n,this.snake=new r("#101f15",t.ArrowRight),this.snake2=new c("#f4deb3",t.KeyA),this.snake.initialize(this.ctx),this.snake2.initialize(this.ctx),this.foodCoord=this.#t(),this.#e()}#e(){this.snake.move(this.snake.nextDirection,this.ctx),this.snake.direction=this.snake.nextDirection,this.snake2.move(this.snake2.nextDirection,this.ctx),this.snake2.direction=this.snake2.nextDirection;const t=this.#i();null!=t?this.#s(t):(this.#o(),setTimeout((()=>this.#e()),Math.max(this.tickRate--/n,o)))}#i(){let t=null;return(this.snake.body.has(this.snake.head.coord.toString())||this.snake2.body.has(this.snake.head.coord.toString())||super.checkForBoundaryCollision(this.snake.head.coord))&&(t=null==t?"snake":"both"),(this.snake.body.has(this.snake2.head.coord.toString())||this.snake2.body.has(this.snake2.head.coord.toString())||super.checkForBoundaryCollision(this.snake2.head.coord))&&(t=null==t?"snake2":"both"),t}#o(){this.snake.head.coord.x===this.foodCoord.x&&this.snake.head.coord.y===this.foodCoord.y?(this.snake.grow(),this.foodCoord=this.#t()):this.snake2.head.coord.x===this.foodCoord.x&&this.snake2.head.coord.y===this.foodCoord.y&&(this.snake2.grow(),this.foodCoord=this.#t())}#s(t){let e="Draw";switch(t){case"snake":e="White Snake wins!";break;case"snake2":e="Black Snake wins!"}this.infoDisplay.innerText=e,this.infoDisplay.style.display="inline",this.singleBtn.style.display="inline",this.localBtn.style.display="inline"}#t(){let t;for(;!t||this.snake.body.has(t.toString())||this.snake2.body.has(t.toString());)t=new a(super.getRandomInt(this.width/i),super.getRandomInt(this.height/i));return t.drawRect("#d83a20",20,this.ctx),t}}CanvasRenderingContext2D.prototype.roundRect=function(t,e,i,s,o){return i<2*o&&(o=i/2),s<2*o&&(o=s/2),this.beginPath(),this.moveTo(t+o,e),this.arcTo(t+i,e,t+i,e+s,o),this.arcTo(t+i,e+s,t,e+s,o),this.arcTo(t,e+s,t,e,o),this.arcTo(t,e,t+i,e,o),this.closePath(),this};const k=document.getElementById("snakeLayer"),y=k.getContext("2d"),w=document.getElementById("1p"),g=document.getElementById("2pLocal"),x=document.getElementById("info");let u;async function f(){w.style.display="none",g.style.display="none",await u.start()}w.addEventListener("click",(async()=>{u=new d(y,x,w,g,parseInt(k.width),parseInt(k.height)),await f()})),g.addEventListener("click",(async()=>{u=new l(y,x,w,g,parseInt(k.width),parseInt(k.height)),await f()})),document.onkeydown=e=>{const i=function(e){return t[e]}(e.code);i===t.ArrowDown||i===t.ArrowUp?u.snake.direction!==t.ArrowLeft&&u.snake.direction!==t.ArrowRight||(u.snake.nextDirection=i):i===t.ArrowLeft||i===t.ArrowRight?u.snake.direction!==t.ArrowUp&&u.snake.direction!==t.ArrowDown||(u.snake.nextDirection=i):i===t.KeyW||i===t.KeyS?u.snake2.direction!==t.KeyA&&u.snake2.direction!==t.KeyD||(u.snake2.nextDirection=i):i!==t.KeyA&&i!==t.KeyD||u.snake.direction!==t.KeyS&&u.snake2.direction!==t.KeyW||(u.snake2.nextDirection=i)}})();